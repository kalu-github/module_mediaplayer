!function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t){!function(){let e=!1;const t=[];window.SlardarWeb("on","start",()=>{for(e=!0;t.length;){t.shift()()}});const o=(o,n)=>{const{metric:r,categories:s}=n||{metric:void 0,categories:void 0};e?window.SlardarWeb("sendEvent",{name:o,metric:r,categories:s}):t.push(()=>{window.SlardarWeb("sendEvent",{name:o,metric:r,categories:s})})},n=/headless/i.test(navigator.userAgent),r=!PluginArray.prototype===navigator.plugins.__proto__,s=!navigator.languages,i=!!navigator.webdriver,a=!window.outerHeight&&!window.outerWidth,c=n||r||s||i||a;if(window.isHeadless=c,o("headless_detect",{categories:{isHeadless:c,isHeadlessUA:n,isHeadlessPlugins:r,isHeadlessLanguages:s,isHeadlessWebdriver:i,isHeadlessOuter:a}}),c)return;if("function"!=typeof Promise||"function"!=typeof Promise.any||"function"!=typeof Proxy||"function"!=typeof Set||"function"!=typeof AbortController||"function"!=typeof URL||"object"!=typeof Reflect||"function"!=typeof String.prototype.startsWith)return;console.log("cdn retry running");const u=/(jj|passport|juejin|cdn-tos)\.(byteimg|bytescm)/i,l=/(cdn-tos)\.bytescm/i,m=/^(https|http):\/\//i,f=/^\/\//i,d="-1",p="0",g="1",b=new Set,y=new Set,h=new Proxy({jj:{usableDomain:"",hasRunPing:!1,backups:["p1-jj.byteimg.com","p2-jj.byteimg.com","p6-jj.byteimg.com","p9-jj.byteimg.com"],errorQueue:[],source:"/tos-cn-i-t2oaga2asx/gold-user-assets/2018/7/16/164a1386a8b82dbd~tplv-t2oaga2asx-no-mark:50:50:50:50.jpg"},juejin:{usableDomain:"",hasRunPing:!1,backups:["p1-juejin.byteimg.com","p3-juejin.byteimg.com","p6-juejin.byteimg.com","p9-juejin.byteimg.com"],source:"/tos-cn-i-k3u1fbpfcp/7b420fc725a54dc4a3111dc4a3866961~tplv-k3u1fbpfcp-no-mark:240:240:240:160.jpg",errorQueue:[]},passport:{usableDomain:"",hasRunPing:!1,backups:["p3-passport.byteimg.com","p6-passport.byteimg.com"],source:"/img/user-avatar/ec67e169b62e429d9ea7a782a92d69d6~100x100.jpg",errorQueue:[]},"cdn-tos":{usableDomain:"",hasRunPing:!1,backups:["lf-cdn-tos.bytescm.com","lf1-cdn-tos.bytescm.com","lf3-cdn-tos.bytescm.com","lf6-cdn-tos.bytescm.com"],source:"obj/static/xitu_juejin_web/static/favicon.ico",errorQueue:[]}},{get(e,t){const o=Reflect.get(e,t);return"object"==typeof o?new Proxy(o,this):o},set(e,t,o){if("usableDomain"===t&&o){const{errorQueue:t}=e;for(;t.length;){const e=t.shift();w(e,o)}}return Reflect.set(e,t,o)}}),j=e=>{if(e&&!e.startsWith("data:image"))try{return new URL(v(e))}catch(t){console.log(t,e)}},w=(e,t)=>{const n=e.src?"src":"href",r=e[n],s=P(r,t);b.has(s)||(y.add(s),e[n]=s,o("cdn_assets_fix",{categories:{url:s,status:d,originalUrl:r}}))},v=e=>(f.test(e)?e="https:"+e:m.test(e)||(e="https://"+e),e),P=(e,t)=>{const o=j(e);if(o){const e=v(t),n=new URL(e);return o.host=n.host,o.port=n.port,o.protocol=n.protocol,o.href}},_=async(e,t)=>{const{backups:o,source:n}=h[e];try{const r=await Promise.any(o.map(e=>{const o=v(e+n);return"img"===t?((e="",t=3e3)=>new Promise((o,n)=>{if(!e)return void n("loadImage error: src is empty");const r=j(e);if(!r)return;const s=r.hostname,i=new Image,a=setTimeout(()=>{n(!1)},t);i.onload=()=>{clearTimeout(a),o(s)},i.onerror=()=>{clearTimeout(a),n(!1)},i.src=e}))(o):((e,t=3e3)=>new Promise((o,n)=>{if(!e)return void n("loadSource error: src is empty");const r=j(e);if(!r)return;const s=r.hostname,i=new AbortController,a=setTimeout(()=>i.abort(),t);return fetch(e,{signal:i.signal}).then(e=>{e.ok?o(s):n(!1)}).catch(()=>{n(!1)}).finally(()=>{clearTimeout(a)})}))(o)}));h[e].usableDomain=r}catch(e){console.log(e)}},x=(e,t,n)=>{const{target:r}=e;if(r.tagName.toLowerCase()===t){const e=j(r[n]);if(!e)return;const{hostname:s,href:i}=e;y.has(i)&&o("cdn_assets_fix",{categories:{url:i,status:g}});const a=s.match("img"===t?u:l);if(a){const e=a[1];h[e].usableDomain||(h[e].usableDomain=s)}}},S=(e,t,n)=>{const{target:r}=e;if(r.tagName.toLowerCase()===t){b.add(r[n]);const e=j(r[n]);if(!e)return;const{hostname:s,href:i}=e;y.has(i)&&o("cdn_assets_fix",{categories:{url:i,status:p}});const a=s.match("img"===t?u:l);if(a){const e=a[1],o=h[e];o.usableDomain?w(r,o.usableDomain):(o.errorQueue.push(r),o.hasRunPing||(_(e,t),o.hasRunPing=!0))}}};document.addEventListener("load",e=>{x(e,"img","src"),x(e,"link","href")},!0),document.addEventListener("error",e=>{S(e,"img","src"),S(e,"link","href")},!0)}()}]);